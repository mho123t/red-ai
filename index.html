<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدارة موظفي ريدان للمندي</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #8B0000;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        h1 {
            margin: 0;
        }
        .section {
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        .btn {
            background-color: #8B0000;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 2px;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .whatsapp-btn {
            background-color: #25D366;
        }
        .delete-btn {
            background-color: #ff3333;
        }
        form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Tajawal', sans-serif;
        }
        .full-width {
            grid-column: span 2;
        }
        .loading {
            text-align: center;
            padding: 20px;
        }
        @media (max-width: 768px) {
            form {
                grid-template-columns: 1fr;
            }
            .full-width {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>نظام إدارة الموظفين - ريدان للمندي</h1>
        </header>

        <div class="section">
            <h2>إضافة موظف جديد</h2>
            <form id="employeeForm">
                <div class="form-group">
                    <label for="name">اسم الموظف</label>
                    <input type="text" id="name" required>
                </div>
                <div class="form-group">
                    <label for="position">الوظيفة</label>
                    <select id="position" required>
                        <option value="">اختر الوظيفة</option>
                        <option value="طباخ">طباخ</option>
                        <option value="نادل">نادل</option>
                        <option value="مشرف">مشرف</option>
                        <option value="موظف استقبال">موظف استقبال</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="phone">رقم الهاتف</label>
                    <input type="tel" id="phone" required>
                </div>
                <div class="form-group">
                    <label for="salary">الراتب</label>
                    <input type="number" id="salary" required>
                </div>
                <div class="form-group full-width">
                    <button type="submit" class="btn">حفظ الموظف</button>
                </div>
            </form>
        </div>

        <div class="section">
            <h2>قائمة الموظفين</h2>
            <div id="loadingEmployees" class="loading">جاري تحميل بيانات الموظفين...</div>
            <table id="employeesTable" style="display:none;">
                <thead>
                    <tr>
                        <th>الاسم</th>
                        <th>الوظيفة</th>
                        <th>رقم الهاتف</th>
                        <th>الراتب</th>
                        <th>إجراءات</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div class="section">
            <h2>تواصل مع الإدارة</h2>
            <a href="https://wa.me/971588155123" class="btn whatsapp-btn">تواصل عبر واتساب</a>
        </div>
    </div>

    <script>
        // الرابط الذي قدمته
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxCf6WiPjTlwiBC1cJLm79wxYSonyj_wqHTrz4IC0jj52FPlxAcfquAqgqUhoB7UUDoLA/exec";
        
        document.addEventListener('DOMContentLoaded', function() {
            // جلب بيانات الموظفين عند تحميل الصفحة
            loadEmployees();
            
            // إرسال بيانات الموظف الجديد
            document.getElementById('employeeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('name').value;
                const position = document.getElementById('position').value;
                const phone = document.getElementById('phone').value;
                const salary = document.getElementById('salary').value;
                
                if(!name || !position || !phone || !salary) {
                    alert("الرجاء ملء جميع الحقول");
                    return;
                }
                
                const formData = new FormData();
                formData.append('name', name);
                formData.append('position', position);
                formData.append('phone', phone);
                formData.append('salary', salary);
                formData.append('action', 'add_employee');
                
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if(data.success) {
                        alert("تم إضافة الموظف بنجاح");
                        document.getElementById('employeeForm').reset();
                        loadEmployees();
                    } else {
                        alert("حدث خطأ: " + (data.message || 'غير معروف'));
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert("حدث خطأ أثناء حفظ البيانات");
                });
            });
        });
        
        function loadEmployees() {
            document.getElementById('loadingEmployees').style.display = 'block';
            document.getElementById('employeesTable').style.display = 'none';
            
            fetch(GOOGLE_SCRIPT_URL + '?action=get_employees')
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.querySelector('#employeesTable tbody');
                    tableBody.innerHTML = '';
                    
                    if(data && data.length > 0) {
                        data.forEach(employee => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${employee.name || ''}</td>
                                <td>${employee.position || ''}</td>
                                <td>${employee.phone || ''}</td>
                                <td>${employee.salary || ''}</td>
                                <td>
                                    <button class="btn delete-btn" onclick="deleteEmployee('${employee.id}')">حذف</button>
                                </td>
                            `;
                            tableBody.appendChild(row);
                        });
                        
                        document.getElementById('loadingEmployees').style.display = 'none';
                        document.getElementById('employeesTable').style.display = 'table';
                    } else {
                        document.getElementById('loadingEmployees').innerHTML = 'لا يوجد موظفين مسجلين';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('loadingEmployees').innerHTML = 'حدث خطأ أثناء جلب البيانات';
                });
        }
        
        function deleteEmployee(employeeId) {
            if(confirm("هل أنت متأكد من حذف هذا الموظف؟")) {
                fetch(GOOGLE_SCRIPT_URL + '?action=delete_employee&id=' + employeeId)
                    .then(response => response.json())
                    .then(data => {
                        if(data.success) {
                            alert("تم حذف الموظف بنجاح");
                            loadEmployees();
                        } else {
                            alert("حدث خطأ: " + (data.message || 'غير معروف'));
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert("حدث خطأ أثناء حذف الموظف");
                    });
            }
        }
    </script>
</body>
</html>